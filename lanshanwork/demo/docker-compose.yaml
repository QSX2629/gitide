# docker-compose.yml：一次性启动/管理web+db两个容器
services:
  web:
    image: nginx:latest  # 用现成的nginx镜像，无需Dockerfile
    ports:
      - "8080:80"  # 暴露端口：主机端口:容器端口
    depends_on:
      - db  # 依赖db服务，启动时先启动db
    networks:
      - my_bridge_net  # 加入自定义bridge网络

  db:  # 数据库容器名
    image: mysql:latest  # 拉取最新mysql镜像
    environment:  # 环境变量（配置mysql密码）
      MYSQL_ROOT_PASSWORD: Qsx20061212
    volumes:
      - db_data:/var/lib/mysql  # 数据持久化：将mysql数据目录挂载到volume
    networks:
      - my_bridge_net  # 加入自定义bridge网络

# 自定义bridge网络（满足要求1）
networks:
  my_bridge_net:
    driver: bridge  # 网络类型为bridge

# 数据持久化volume（满足要求2）
volumes:
  db_data:  # 自动创建的volume，用于保存db数据